CREATE DATABASE sales_analysisdb;
USE sales_analysis;

CREATE TABLE online_sales (
    order_id INT PRIMARY KEY,
    order_date DATE,
    amount DECIMAL(10,2),
    product_id INT
);

INSERT INTO online_sales (order_id, order_date, amount, product_id) VALUES
(1, '2023-01-05', 100.00, 101),
(2, '2023-01-12', 150.00, 102),
(3, '2023-02-10', 200.00, 101),
(4, '2023-02-25', 175.00, 103),
(5, '2023-03-05', 220.00, 104),
(6, '2023-03-15', 190.00, 101),
(7, '2023-04-01', 300.00, 105);
INSERT INTO online_sales (order_id, order_date, amount, product_id) VALUES
(8,  '2023-04-10', 280.00, 106),
(9,  '2023-04-20', 260.00, 107),
(10, '2023-05-02', 310.00, 108),
(11, '2023-05-15', 220.00, 109),
(12, '2023-05-30', 180.00, 101),
(13, '2023-06-01', 275.00, 110),
(14, '2023-06-12', 195.00, 102),
(15, '2023-06-25', 205.00, 104),
(16, '2023-07-01', 315.00, 103),
(17, '2023-07-10', 190.00, 105),
(18, '2023-07-25', 280.00, 106),
(19, '2023-08-01', 225.00, 107),
(20, '2023-08-12', 300.00, 108),
(21, '2023-08-20', 215.00, 109),
(22, '2023-09-01', 190.00, 101),
(23, '2023-09-14', 310.00, 102),
(24, '2023-09-27', 240.00, 110),
(25, '2023-10-01', 280.00, 104),
(26, '2023-10-11', 270.00, 105),
(27, '2023-10-22', 260.00, 106),
(28, '2023-11-05', 300.00, 107),
(29, '2023-11-15', 310.00, 108),
(30, '2023-11-28', 350.00, 109);
INSERT INTO online_sales (order_id, order_date, amount, product_id) VALUES
(31, '2023-12-01', 320.00, 110),
(32, '2023-12-10', 210.00, 101),
(33, '2023-12-20', 180.00, 103),
(34, '2024-01-05', 230.00, 102),
(35, '2024-01-18', 260.00, 104),
(36, '2024-02-02', 290.00, 105),
(37, '2024-02-14', 310.00, 106),
(38, '2024-02-25', 270.00, 107),
(39, '2024-03-03', 250.00, 108),
(40, '2024-03-11', 225.00, 109),
(41, '2024-03-20', 300.00, 110),
(42, '2024-04-01', 280.00, 101),
(43, '2024-04-13', 240.00, 102),
(44, '2024-04-22', 200.00, 103),
(45, '2024-05-05', 195.00, 104),
(46, '2024-05-15', 310.00, 105),
(47, '2024-05-30', 270.00, 106),
(48, '2024-06-01', 265.00, 107),
(49, '2024-06-12', 285.00, 108),
(50, '2024-06-25', 250.00, 109);
INSERT INTO online_sales (order_id, order_date, amount, product_id) VALUES
(51, '2024-07-01', 230.00, 101),
(52, '2024-07-10', 310.00, 102),
(53, '2024-07-20', 275.00, 103),
(54, '2024-07-28', 260.00, 104),
(55, '2024-08-02', 240.00, 105),
(56, '2024-08-12', 215.00, 106),
(57, '2024-08-21', 295.00, 107),
(58, '2024-08-30', 265.00, 108),
(59, '2024-09-05', 280.00, 109),
(60, '2024-09-15', 220.00, 110),
(61, '2024-09-25', 235.00, 101),
(62, '2024-10-01', 310.00, 102),
(63, '2024-10-09', 250.00, 103),
(64, '2024-10-17', 275.00, 104),
(65, '2024-10-26', 285.00, 105),
(66, '2024-11-03', 300.00, 106),
(67, '2024-11-11', 290.00, 107),
(68, '2024-11-20', 270.00, 108),
(69, '2024-11-28', 260.00, 109),
(70, '2024-12-04', 280.00, 110),
(71, '2024-12-12', 295.00, 101),
(72, '2024-12-20', 310.00, 102),
(73, '2024-12-28', 275.00, 103),
(74, '2025-01-03', 260.00, 104),
(75, '2025-01-11', 250.00, 105),
(76, '2025-01-19', 230.00, 106),
(77, '2025-01-27', 290.00, 107),
(78, '2025-02-02', 310.00, 108),
(79, '2025-02-10', 270.00, 109),
(80, '2025-02-18', 255.00, 110),
(81, '2025-02-26', 265.00, 101),
(82, '2025-03-05', 280.00, 102),
(83, '2025-03-13', 290.00, 103),
(84, '2025-03-21', 310.00, 104),
(85, '2025-03-29', 275.00, 105),
(86, '2025-04-04', 265.00, 106),
(87, '2025-04-12', 295.00, 107),
(88, '2025-04-20', 305.00, 108),
(89, '2025-04-28', 285.00, 109),
(90, '2025-05-06', 275.00, 110),
(91, '2025-05-14', 260.00, 101),
(92, '2025-05-22', 240.00, 102),
(93, '2025-05-30', 300.00, 103),
(94, '2025-06-05', 250.00, 104),
(95, '2025-06-13', 270.00, 105),
(96, '2025-06-21', 295.00, 106),
(97, '2025-06-29', 310.00, 107),
(98, '2025-07-04', 265.00, 108),
(99, '2025-07-12', 280.00, 109),
(100, '2025-07-20', 290.00, 110);





SELECT
    EXTRACT(YEAR FROM order_date) AS year,
    EXTRACT(MONTH FROM order_date) AS month,
    SUM(amount) AS total_revenue,
    COUNT(DISTINCT order_id) AS order_volume
FROM
    online_sales
WHERE
    order_date BETWEEN '2023-01-01' AND '2023-12-31'
GROUP BY
    EXTRACT(YEAR FROM order_date),
    EXTRACT(MONTH FROM order_date)
ORDER BY
    year,
    month;
